# Node.js
# Build a general Node.js application with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/vsts/pipelines/languages/javascript

pool:
  vmImage: 'Ubuntu 16.04'
  
steps:
- task: NodeTool@0
  inputs:
    versionSpec: '8.x'
- bash: |
    export CHROME_BIN=/usr/bin/google-chrome
    export DISPLAY=:99.0
    sh -e /etc/init.d/xvfb start
    sudo apt-get -qq update
    sudo apt-get install -y libappindicator1 fonts-liberation
    wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
    sudo dpkg -i google-chrome*.deb
    sleep 3

- script: |
    npm install
    npm run build:style
    npx ng build igniteui-angular --prod
    npm run test:lib
    
